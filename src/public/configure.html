<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Horror Archive - Configure Your Nightmares</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        horror: {
                            blood: '#991b1b', 
                            dark: '#050505', 
                            card: 'rgba(15, 0, 0, 0.9)',
                            button: '#7f1d1d', 
                            text: '#d1d5db',
                            accent: '#ef4444' 
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        [v-cloak] { display: none; }
        body {
            background-color: #000;
            background-image: radial-gradient(circle at center, #1a0000 0%, #000 100%);
            min-height: 100vh;
            font-family: 'Courier New', Courier, monospace;
        }
        .glassmorphic {
            background: rgba(10, 0, 0, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(153, 27, 27, 0.3);
            box-shadow: 0 0 40px rgba(153, 27, 27, 0.2);
            border-radius: 15px;
        }
        .catalog-item {
            background-color: #0a0a0a;
            border: 1px solid rgba(153, 27, 27, 0.2);
            transition: all 0.2s ease-out;
            color: #666;
        }
        .catalog-item:hover {
            border-color: #991b1b;
            color: #ef4444;
        }
        .catalog-item.selected {
            background: linear-gradient(145deg, #7f1d1d, #450a0a);
            color: #fff;
            border-color: #ef4444;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
        .install-button {
            background: #991b1b;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 900;
            transition: all 0.3s ease;
        }
        .install-button:hover:not(:disabled) {
            background: #ef4444;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.4);
        }
        /* Efeito de scanline clássico de filme de terror */
        body::after {
            content: " ";
            display: block;
            position: fixed;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            z-index: 100;
            background-size: 100% 4px;
            pointer-events: none;
            opacity: 0.2;
        }
    </style>
</head>
<body class="text-horror-text py-8 px-4">
    <div id="app" v-cloak class="max-w-2xl mx-auto">
        <div class="text-center mb-10">
            <h1 class="text-5xl font-black tracking-tighter text-horror-blood uppercase italic drop-shadow-[0_0_15px_rgba(153,27,27,0.8)]">Horror Archive</h1>
            <p class="text-[10px] text-gray-500 uppercase tracking-[0.3em] mt-2">The definitive collection of supernatural files</p>
        </div>
        
        <div class="glassmorphic p-8">
            <div class="flex justify-between items-center mb-6 border-b border-horror-blood/30 pb-4">
                <h2 class="text-sm uppercase tracking-widest text-horror-accent font-bold">Files to decrypt:</h2>
                
                <button @click="toggleAll" class="px-4 py-1 rounded-full text-[10px] border border-horror-blood/50 text-horror-accent uppercase font-bold tracking-widest hover:bg-horror-blood hover:text-white transition-all">
                    <i :class="allSelected ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                    {{ allSelected ? 'Discard All' : 'Awaken All' }}
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-8">
                <div 
                    v-for="catalog in catalogs" 
                    :key="catalog.id" 
                    @click="toggleCatalog(catalog)"
                    :class="['catalog-item p-4 rounded-md cursor-pointer flex items-center justify-between', {'selected': selectedCatalogs.includes(catalog.id)}]"
                >
                    <div class="flex items-center space-x-3">
                        <i :class="['fas', selectedCatalogs.includes(catalog.id) ? 'fa-skull' : 'fa-ghost']"></i>
                        <span class="font-bold text-[11px] uppercase tracking-tight">{{ catalog.name }}</span>
                    </div>
                    <i v-if="selectedCatalogs.includes(catalog.id)" class="fas fa-check text-[10px]"></i>
                </div>
            </div>

            <button @click="generateLink" :disabled="selectedCatalogs.length === 0" class="install-button w-full py-5 rounded-sm disabled:opacity-30 animate-pulse-slow">
                Generate Archive Link
            </button>
        </div>

        <transition name="fade">
            <div v-if="showInstallPanel" class="fixed inset-0 bg-black/95 flex items-center justify-center z-50 p-4 backdrop-blur-md">
                <div class="bg-zinc-950 border-2 border-horror-blood p-8 rounded-none max-w-sm w-full shadow-[0_0_70px_rgba(153,27,27,0.4)] text-center">
                    <div class="mb-6">
                        <i class="fas fa-unlock-alt text-horror-blood text-4xl mb-4"></i>
                        <h3 class="text-horror-accent font-black uppercase tracking-widest italic">Encrypted URL Ready</h3>
                    </div>
                    
                    <div class="bg-black/50 p-3 mb-6 rounded border border-white/5">
                        <p class="text-[10px] text-zinc-500 break-all font-mono">{{ installUrl }}</p>
                    </div>

                    <div class="flex flex-col gap-4">
                        <a :href="stremioUrl" class="install-button py-4 rounded-sm text-sm flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i> Install to Stremio
                        </a>
                        <button @click="copyToClipboard" class="bg-zinc-900 text-horror-blood border border-horror-blood/30 py-4 rounded-sm text-xs uppercase font-bold hover:bg-horror-blood hover:text-white transition">
                            <i class="fas fa-copy mr-2"></i> {{ copied ? 'Link Copied!' : 'Copy Manifesto URL' }}
                        </button>
                        <button @click="showInstallPanel = false" class="text-gray-600 text-[10px] mt-2 uppercase tracking-widest hover:text-white underline">Back to Shadows</button>
                    </div>
                </div>
            </div>
        </transition>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                catalogs: [
                    {id: 'cj-r', name: 'The Conjuring: Release'},
                    {id: 'cj-t', name: 'The Conjuring: Timeline'},
                    {id: 'sc', name: 'Scream: Full Saga'},
                    {id: 'hw', name: 'Halloween: Complete'},
                    {id: 'sw', name: 'Saw: Chronological'},
                    {id: 'f13', name: 'Friday the 13th'},
                    {id: 'ck', name: 'Chucky Saga'},
                    {id: 'nm', name: 'A Nightmare on Elm Street'},
                    {id: 'sk', name: 'Stephen King Archives'},
                    {id: 'ms', name: 'Modern Sagas'},
                    {id: 'tv', name: 'Horror TV Series'}
                ],
                selectedCatalogs: [],
                showInstallPanel: false,
                stremioUrl: '',
                installUrl: '',
                copied: false
            },
            computed: {
                allSelected() {
                    return this.selectedCatalogs.length === this.catalogs.length;
                }
            },
            methods: {
                toggleCatalog(catalog) {
                    const index = this.selectedCatalogs.indexOf(catalog.id);
                    if (index === -1) this.selectedCatalogs.push(catalog.id);
                    else this.selectedCatalogs.splice(index, 1);
                },
                toggleAll() {
                    if (this.allSelected) {
                        this.selectedCatalogs = [];
                    } else {
                        this.selectedCatalogs = this.catalogs.map(c => c.id);
                    }
                },
                generateLink() {
                    const host = window.location.host;
                    const protocol = window.location.protocol;
                    
                    // LÓGICA DO LINK LIMPO:
                    // Se todas as sagas estiverem selecionadas, não colocamos códigos na URL.
                    let manifestPath = "";
                    if (this.allSelected) {
                        manifestPath = "manifest.json";
                    } else {
                        const config = this.selectedCatalogs.join(',');
                        manifestPath = `${config}/manifest.json`;
                    }
                    
                    this.installUrl = `${protocol}//${host}/${manifestPath}`;
                    // O Stremio usa o protocolo stremio:// para abrir o app direto
                    this.stremioUrl = `stremio://${host}/${manifestPath}`;
                    this.showInstallPanel = true;
                },
                copyToClipboard() {
                    navigator.clipboard.writeText(this.installUrl).then(() => {
                        this.copied = true;
                        setTimeout(() => this.copied = false, 2000);
                    });
                }
            }
        });
    </script>
</body>
</html>